---
title: 防抖、节流
date: 2023-07-10
isShowComments: true    
categories:
 - js
tags:
 - js
sidebar: 'auto'

---

# 防抖、节流
准备
---
```html
<div id="demo"></div>
<style>
    #demo{
        width: 500px;
        height: 500px;
        background-color: aquamarine;
    }
</style>
```

---
防抖: 
---
连续触发只会执行一次，最后一次在规定时间之后才会执行

```js
var demo = document.getElementById('demo')
var num = 1
function demoFunc(){
    demo.innerHTML  = num ++
}

//func--函数
//wait--延迟执行毫秒数
//immediate--true立即执行，false非立即执行可以为空

function debounce(func,wait,immediate){
    var timer;
    return function(){
        let context = this
        let args = arguments
        if(timer)clearTimeout(timer);//阻止方法执行函数
        if(immediate){
            let nowTime = !timer
            timer = setTimeout(()=>{
                timer = null
            },wait)
            if(nowTime)func.apply(context,args);
        }else{
            timer=setTimeout(()=>{
                func.apply(context,args)
            },wait)
        }
    }
}

demo.onmousemove = debounce(demoFunc,1000,true) 
```
---
节流: 
---
频繁触发变为少量触发，在规定时间间隔内不会重复触发回调，只有大于时间间隔才会触发

```js
//严格模式
// 定时器版
function throttle(func,wait){
    var timer;
    return function(){
        let context = this
        let args = arguments
        if(!timer){
            timer = setTimeout(()=>{
                timer = null
                func.apply(context,args);
            },wait)
        }
    }
}

// 时间戳版
function throttleTime(func,wait){
    var count = 0
    return function(){
        let nowTime = Date.now()
        if(nowTime-count >= wait){
            func.apply(this,arguments)
            count = Date.now()
        }
    }
}
```
